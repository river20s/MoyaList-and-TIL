# HTTP 프로토콜

[URL](https://github.com/river20s/TIL/blob/main/Networks/HTTP-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C.md)을 해독하여 어디에 액세스 해야 하는지 알게 된 브라우저는, HTTP 프로토콜을 사용하여 웹 서버에 액세스한다. 여기서 HTTP 프로토콜이란 클라이언트와 서버가 주고 받는 메시지의 내용이나 순서를 약속한 것이다. 

> The HyperText Transfer Protocol (**HTTP**)은 [Web](https://developer.mozilla.org/ko/docs/Glossary/World_Wide_Web)에서 하이퍼미디어 문서를 전송하는 네트워크 [프로토콜](https://developer.mozilla.org/ko/docs/Glossary/Protocol)입니다. 일반적으로 하이퍼미디어 문서를 사람들이 읽을 수 있도록 브라우저와 서버 사이에 존재합니다. 현재 버전의 HTTP 명세는 [HTTP/2](https://developer.mozilla.org/ko/docs/Glossary/HTTP_2)입니다.
>
> (출처: [mdn web docs | HTTP](https://developer.mozilla.org/ko/docs/Glossary/HTTP))

### HTTP의 동작 과정

먼저, 클라이언트에서 서버를 향해 리퀘스트 메시지를 보낸다. 리퀘스트 메시지의 안에는 '무엇을' '어떻게' 하겠다는 정보가 담겨있다. 여기서 '무엇을'에 해당하는 것을 [URI(Uniform Resource Identifier)](https://developer.mozilla.org/ko/docs/Glossary/URI)라고 하는데, 보통 페이지 데이터를 저장한 파일의 이름이나 [CGI 프로그램](https://www.ibm.com/docs/ko/i/7.5?topic=functionality-cgi)의 파일명을 URI로 쓴다. 또는 http: 로 시작하는 URL을 그대로 쓸 수도 있다. 아무튼 '무엇을'의 안에는 다양한 액세스 대상을 넣을 수 있으며, 그런 액세스 대상을 통칭하는 말이 URI이다.

그 다음 '어떻게'에 해당하는 것이 메서드로, 웹 서버에 어떤 동작을 하고 싶은지 전달한다. 

| 메소드  | HTTP 1.0 | HTTP 1.1 | 의미                                                         |
| ------- | -------- | -------- | ------------------------------------------------------------ |
| GET     | ◯        | ◯        | URI로 지정한 정보를 도출함.                                  |
| POST    | ◯        | ◯        | 클라이언트에서 서버로 데이터를 송신함. <br />폼에 입력한 데이터를 송신하려는 경우. |
| HEAD    | ◯        | ◯        | HTTP 메시지 헤더만 반환하고 데이터의 내용은 돌려보내지 않음. |
| OPTIONS |          | ◯        | 통신 옵션을 통지하거나 조사할 때 사용함.                     |
| PUT     | △        | ◯        | URI로 지정한 서버의 파일을 치환함. URI로 지정한 파일이 없는 경우 새 파일을 작성함. |
| DELETE  | △        | ◯        | URI로 지정한 파일을 삭제함.                                  |
| TRACE   |          | ◯        | 서버측에서 받은 리퀘스트 라인과 헤더를 그대로 클라이언트에 반송함. 프록시 서버 등을 사용하는 환경에서 리퀘스트가 치환되는 상태를 조사할 때 사용함. |
| CONNECT |          | ◯        | 암호화한 메시지를 프록시로 전송할 때 사용함.                 |

<sub>위 표는 책에 나와있는 표 1-1을 옮긴 것이다. ◯는 각 버전에서 사용으로 정의되어 있는 것, △는 정식 사양이 아니라 부가 기능으로 부록에 기술되어 있는 것이다.</sub>

리퀘스트 메시지가 웹 서버에 도착하면 웹 서버는 그 속에 쓰여있는 내용을 해석하여 '무엇을' '어떻게' 할 것인지 판단한 후 요구에 따라 동작하고, 결과 데이터를 응답 메시지에 저장한다. 

> **스테이터스 코드 - 응답 메시지의 앞 부분**
>
> 응답 메시지의 맨 앞에는 실행 결과가 정상 종료되었는지 또는 이상이 발생했는지를 나타내는 스테이터스 코드가 있다. 대표적으로 "404 Not Found" 같은 것이 그 예다.

스테이터스 코드 뒤에는 헤더 파일과 페이지의 데이터가 이어지고, 이 응답 메시지를 클라이언트에게 다시 전송한다. 그러면 브라우저가 메시지의 안에서 데이터를 추출하여 화면에 표시하면서 HTTP 동작이 끝나게 된다.



## 메서드의 종류

### GET

웹 서버에 액세스하여 페이지의 데이터를 읽을 때 사용한다. 리퀘스트 메시지의 메서드에 `GET`이라고 쓰고, URI에는 `/dir1/file1.html` 과 같이 페이지의 데이터를 저장한 파일의 이름을 쓴다. 웹 서버는 이 메시지를 받아  `/dir1/file1.html`  파일을 열고 그 내용의 데이터를 추출한다.

### POST

**폼**<sub>(웹 페이지에 있는 텍스트 입력 상자나 체크박스 등이 표시된 부분)</sub>에 데이터를 사용해서 웹 서버에 송신하는 경우 사용한다. POST 메서드를 사용한 경우 URI는 웹 서버 기계에서 동작하는 애플리케이션 프로그램의 파일명을 쓴다. 그리고 [스크립트](https://ko.wikipedia.org/wiki/%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8_%EC%96%B8%EC%96%B4)에 건네주는 데이터도 쓰는데 이 데이터는 사용자가 필드에 입력한 값이다. 메시지가 서버 기계에 도착하면 웹 서버 소프트웨어는 URI에 지정된 애플리케이션 프로그램에게 리퀘스트 메시지 안에 쓰여있는 데이터를 건네준다. 그리고 이 프로그램이 출력하는 결과를 받아서 응답 메시지에 포함시킨다.

## HTTP 리퀘스트 메시지를 만들다

URL을 해독하고 웹 서버와 파일명을 판단한 브라우저는 HTTP 리퀘스트 메시지를 만든다. 다음은 리퀘스트 메시지를 만드는 포맷이다.

```HTTP
<메소드><공백><URI><공백><HTTP 버전>
<필드명>:<필드값>


<공백 행>
<메시지 본문>
```

- 첫 번째 행을 '리퀘스트 라인'이라고 한다. 리퀘스트 라인만으로도 내용을 대략 알 수 있다.
- 메시지 헤더는 필드명부터 이어지는 공백 행이다. 한 행에 하나의 헤더 필드를 쓴다. 이를 통해 리퀘스트의 부가적인 정보를 나타낸다. 공백 행까지가 메시지 헤더가 된다.
- 메시지 본문은 클라이언트에서 서버로 송신하는 데이터이다. 

아래 내용은 응답 메시지의 포맷이다.

```HTTP
<HTTP 버전><공백><스테이터스 코드><공백><응답 문구>
<필드명>:<필드값>

<공백 행>
<메시지 본문>
```

